import{u as L,R as k,f as I,g as N,h as B,j as e,i as _,k as T,m as F,o as V,p as P,q as O,r as z,s as M,t as U,v as m,z as l}from"./admin-CKRX_Iv4.js";import{c as q,u as W,d as G,r}from"./router-CINeAvhf.js";import{AgentDetailsView as H,OnboardingDataTab as J,ClientDetailsTab as K,AIEmployeesTab as Q,TransactionsTab as X}from"./ClientManagement-LDq2AWno.js";import"./icons-DnVO2Lau.js";import"./vendor-DJG_os-6.js";const ne=()=>{const{clientId:d}=q(),c=W(),o=G(),{theme:Y,currentTheme:t}=L(),[s,h]=r.useState(o.state?.client||null),[v,u]=r.useState(!o.state?.client),[i,y]=r.useState("onboarding"),[p,b]=r.useState(null),[w,f]=r.useState("details");r.useEffect(()=>{d&&(async()=>{if(o.state?.client){console.log("âœ… Client data received from navigation state:",o.state.client),h(o.state.client),u(!1);return}try{u(!0),console.log("ðŸ”„ Fetching client details from API for ID:",d);const n=await m.getClientById(d);console.log("âœ… Client data fetched from API:",n),n?.success&&n?.data?h(n.data):(l.error("Client not found"),c("/dashboard/clients"))}catch(n){console.error("âŒ Error fetching client:",n),l.error("Failed to load client details"),c("/dashboard/clients")}finally{u(!1)}})()},[d,c,o.state]),r.useEffect(()=>{if(s){const a=s?.userData?.fullName||s?.company_basics?.name||"Client",n=j.find(E=>E.id===i)?.label||"Details";document.title=`${a} - ${n} | ShivAI Admin`}else document.title="Client Details | ShivAI Admin";return()=>{document.title="ShivAI Admin"}},[s,i]);const g=()=>{c("/dashboard/clients")},$=a=>{l("Edit functionality coming soon",{icon:"â„¹ï¸",duration:3e3})},C=async a=>{if(window.confirm(`Are you sure you want to delete ${a?.userData?.fullName||"this client"}?`))try{await m.deleteClient(a?._id),l.success("Client deleted successfully"),c("/dashboard/clients")}catch(n){console.error("Error deleting client:",n),l.error("Failed to delete client")}},A=async a=>{try{await m.approveClient(a?._id),l.success("Client approved successfully");const n=await m.getClientById(d);n?.success&&n?.data&&h(n.data)}catch(n){console.error("Error approving client:",n),l.error("Failed to approve client")}},R=async a=>{try{await m.rejectClient(a?._id),l.success("Client rejected successfully"),c("/dashboard/clients")}catch(n){console.error("Error rejecting client:",n),l.error("Failed to reject client")}},S=a=>{console.log("View agent:",a),b(a),f("agentView")},D=()=>{b(null),f("details")},j=[{id:"onboarding",label:"Onboarding Data",icon:k},{id:"details",label:"Client Details",icon:I},{id:"employees",label:"AI Employees",icon:N},{id:"transactions",label:"Transactions",icon:B}];if(v)return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});if(!s)return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(_,{className:"w-16 h-16 mx-auto mb-4 text-red-500"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Client Not Found"}),e.jsx("button",{onClick:g,className:"px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors",children:"Back to Clients"})]})});if(w==="agentView"&&p)return e.jsx(H,{agent:p,onBack:D,currentTheme:t});const x={totalAIEmployees:s?.ai_employees?.length||0,liveAIEmployees:s?.ai_employees?.filter(a=>a.status==="active")?.length||0,totalCalls:1247,totalRevenue:2450,isActive:s?.isApproved||!1};return e.jsxs("div",{className:"space-y-4 md:space-y-6",children:[e.jsx("div",{className:"flex flex-col gap-3 sm:gap-0",children:e.jsxs("div",{className:"flex items-start justify-between gap-3 sm:gap-4 min-w-0",children:[e.jsxs("div",{className:"flex items-start gap-3 sm:gap-4 min-w-0 flex-1",children:[e.jsx("button",{onClick:g,className:`p-2 rounded-lg ${t.hover} ${t.text} transition-all duration-200 flex-shrink-0 mt-1`,children:e.jsx(T,{className:"w-5 h-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h1",{className:`text-xl sm:text-2xl font-bold ${t.text} truncate`,children:s?.userData?.fullName||s?.company_basics?.name||"Client Details"}),e.jsx("p",{className:`text-sm ${t.textSecondary} truncate mt-1`,children:s?.userData?.email||s?.company_basics?.company_email||""})]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[(s?.userData?.isOnboarded||s?.isOnboarded)&&!s?.onboarding?.status==="approved"&&!s?.isRejected&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>A(s),className:"px-3 py-1.5 bg-green-500 hover:bg-green-600 text-white text-sm font-medium rounded-lg transition-all duration-200 flex items-center gap-1.5",children:[e.jsx(F,{className:"w-4 h-4"}),"Accept"]}),e.jsxs("button",{onClick:()=>R(s),className:"px-3 py-1.5 bg-red-500 hover:bg-red-600 text-white text-sm font-medium rounded-lg transition-all duration-200 flex items-center gap-1.5",children:[e.jsx(V,{className:"w-4 h-4"}),"Reject"]})]}),e.jsx("button",{onClick:()=>$(),className:`p-2 rounded-lg ${t.hover} ${t.text} transition-all duration-200`,title:"Edit Client",children:e.jsx(P,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>C(s),className:"p-2 rounded-lg hover:bg-red-50 text-red-600 transition-all duration-200",title:"Delete Client",children:e.jsx(O,{className:"w-5 h-5"})})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-4",children:[e.jsxs("div",{className:`${t.cardBg} border ${t.border} rounded-xl p-3 md:p-4`,children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx(N,{className:`w-5 h-5 ${t.textSecondary}`})}),e.jsx("p",{className:`text-2xl md:text-3xl font-bold ${t.text}`,children:x.totalAIEmployees}),e.jsx("p",{className:`text-xs ${t.textSecondary} mt-1`,children:"AI Employees"})]}),e.jsxs("div",{className:`${t.cardBg} border ${t.border} rounded-xl p-3 md:p-4`,children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx(z,{className:`w-5 h-5 ${t.textSecondary}`})}),e.jsx("p",{className:`text-2xl md:text-3xl font-bold ${t.text}`,children:x.liveAIEmployees}),e.jsx("p",{className:`text-xs ${t.textSecondary} mt-1`,children:"Active Now"})]}),e.jsxs("div",{className:`${t.cardBg} border ${t.border} rounded-xl p-3 md:p-4`,children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx(M,{className:`w-5 h-5 ${t.textSecondary}`})}),e.jsx("p",{className:`text-2xl md:text-3xl font-bold ${t.text}`,children:x.totalCalls}),e.jsx("p",{className:`text-xs ${t.textSecondary} mt-1`,children:"Total Calls"})]}),e.jsxs("div",{className:`${t.cardBg} border ${t.border} rounded-xl p-3 md:p-4`,children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx(U,{className:`w-5 h-5 ${t.textSecondary}`})}),e.jsxs("p",{className:`text-2xl md:text-3xl font-bold ${t.text}`,children:["$",x.totalRevenue.toLocaleString()]}),e.jsx("p",{className:`text-xs ${t.textSecondary} mt-1`,children:"Revenue"})]})]}),e.jsxs("div",{className:`${t.cardBg} border ${t.border} rounded-xl shadow-lg`,children:[e.jsx("div",{className:`border-b ${t.border} px-4 md:px-6`,children:e.jsx("div",{className:"flex gap-1 md:gap-2 overflow-x-auto scrollbar-hide -mb-px",children:j.map(a=>{const n=a.icon;return e.jsxs("button",{onClick:()=>y(a.id),className:`flex items-center gap-2 px-3 md:px-4 py-3 md:py-4 text-sm font-medium border-b-2 transition-all duration-200 whitespace-nowrap ${i===a.id?`border-blue-500 ${t.text}`:`border-transparent ${t.textSecondary} hover:${t.text}`}`,children:[e.jsx(n,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{className:"hidden sm:inline",children:a.label})]},a.id)})})}),e.jsxs("div",{className:"p-6",children:[i==="onboarding"&&e.jsx(J,{client:s,currentTheme:t},`onboarding-${s?._id}`),i==="details"&&e.jsx(K,{client:s,currentTheme:t},`details-${s?._id}`),i==="employees"&&e.jsx(Q,{client:s,currentTheme:t,onViewAgent:S},`employees-${s?._id}-${i}`),i==="transactions"&&e.jsx(X,{client:s,currentTheme:t},`transactions-${s?._id}`)]})]})]})};export{ne as default};
