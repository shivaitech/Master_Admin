import{u as Ne,j as e,s as z,z as w}from"./admin-CXI7OwYX.js";import{u as ve,c as $e,r as n}from"./router-C-JlvvJt.js";import{R as Q,a as G,b as H,c as Se,d as _e,e as Ce,f as De,g as Pe,h as ke,i as Te,j as Ae,k as Le,l as Ee,m as Re,n as Be}from"./index-Dfj_MLPr.js";import{A as Ie,D as Me}from"./DeleteConfirmationModal-C3Mow2gg.js";import{a as as,C as ns,O as is,T as ls}from"./DeleteConfirmationModal-C3Mow2gg.js";import"./vendor-DJG_os-6.js";import"./icons-Cy3jFTXJ.js";const J=[{id:"starter",name:"Starter",apiKey:"Starter Plan",description:"Perfect for small businesses",maxAgents:1,aiEmployees:1,price:"$49/mo"},{id:"professional",name:"Professional",apiKey:"Professional Plan",description:"For Growing Teams & Small Businesses",maxAgents:5,aiEmployees:5,price:"$149/mo"},{id:"business",name:"Business",apiKey:"Business Plan",description:"For Scaling Companies & Mid-Sized Teams",maxAgents:15,aiEmployees:15,price:"$299/mo"},{id:"custom",name:"Custom",apiKey:"Custom Plan",description:"For Large Organizations & Enterprises",maxAgents:999,aiEmployees:999,price:"Custom"}],es=()=>{const{theme:Oe,currentTheme:t}=Ne(),g=ve(),p=$e(),W=()=>new URLSearchParams(p.search).get("tab")||"all",[j,X]=n.useState(""),[m,Y]=n.useState(""),[c,Z]=n.useState(W()),[N,L]=n.useState(null),[E,k]=n.useState("list"),[Fe,R]=n.useState(null),[B,ee]=n.useState(null),[h,I]=n.useState([]),[se,te]=n.useState({all:0,newlySignup:0,pending:0,onboarded:0,approved:0,rejected:0}),[ae,M]=n.useState(!0),[Ve,Ue]=n.useState(!1),[Ke,T]=n.useState(null),[qe,O]=n.useState(!1),[ne,F]=n.useState(!1),[x,V]=n.useState(null),[ze,ie]=n.useState(!1),[Qe,Ge]=n.useState(""),[o,v]=n.useState(1),[$]=n.useState(10),[S,le]=n.useState(0),[u,oe]=n.useState(0),[r,re]=n.useState(null),de=n.useRef(new Set),A=n.useRef(!1);n.useEffect(()=>{const s=new URLSearchParams(p.search);if(s.get("tab")!==c){c==="all"?s.delete("tab"):s.set("tab",c);const l=s.toString(),d=l?`${p.pathname}?${l}`:p.pathname;g(d,{replace:!0})}},[c,p.pathname,p.search,g]),n.useEffect(()=>{const s=i=>{i.target.closest("[data-industry-dropdown]")||(console.log("Clicking outside industry dropdown"),ie(!1))};return document.addEventListener("mousedown",s),()=>document.removeEventListener("mousedown",s)},[]),n.useEffect(()=>{const s=setTimeout(()=>{j!==m&&(Y(j),v(1))},500);return()=>clearTimeout(s)},[j,m]),n.useEffect(()=>{v(1)},[c]);const ce=s=>{const i={page:o,limit:$};switch(s){case"all":return i;case"newlySignup":return{...i,isVerified:!1};case"pending":return{...i,isVerified:!0,isOnboarded:!1};case"onboarded":return{...i,isVerified:!0,isOnboarded:!0};case"approved":return{...i,onboardingStatus:"approved"};case"rejected":return{...i,onboardingStatus:"rejected"};default:return i}},U=async(s=c,i=o)=>{if(A.current){console.log("â­ï¸ Skipping fetch - already in progress");return}try{A.current=!0,M(!0),T(null),de.current.add(s);const l=ce(s);console.log(`ðŸ“¡ Fetching data for tab: ${s} with params:`,l);const d=await z.get("/v1/users",l);console.log(`âœ… Raw response for ${s}:`,d),console.log("âœ… Response data:",d.data);const f=d.data||d,C=f?.data?.users||f?.users||f||[],D=f?.meta||{},P=f?.data?.meta?.pagination||D?.pagination||{};console.log(`ðŸ“Š Extracted users (${C.length}):`,C.length>0?C.slice(0,2):"No users"),console.log("ðŸ“Š Meta data:",D),console.log("ðŸ“Š Pagination data:",P);const ye=C.map(a=>({_id:a?.id||a?._id,onBoardingId:a?.onboarding?._id||null,userData:a,company_basics:{name:a?.onboarding?.company_name||a?.fullName||"Unknown",company_email:a?.onboarding?.company_email||a?.email,company_size:a?.onboarding?.address||a?.address||"Unknown",industry:[a?.onboarding?.region||"Not specified"]},plan_details:{type:a?.userData?.onboarding?.plan_type||a?.onboarding?.plan_type||a?.plan_type||"Selected",ai_employee_limit:a?.onboarding?.ai_employee_count||a?.ai_employee_count||1,monthly_price:(()=>{const q=a?.userData?.onboarding?.plan_type||a?.onboarding?.plan_type,y=J.find(je=>je.apiKey===q);return y?.price==="Custom"?0:parseFloat(y?.price?.replace(/[$\/mo,]/g,"")||"0")})()},ai_employees:a?.onboarding?.ai_employees||Array.from({length:a?.onboarding?.ai_employee_count||0},(q,y)=>({id:`ai_${y+1}`,name:`AI Employee ${y+1}`,type:"Assistant",status:"Active"})),isOnBoarded:a?.isOnBoarded||!1,isApproved:a?.isApproved||!1,createdAt:a?.createdAt,lastLoginAt:a?.lastLoginAt,knowledge_sources:{website_url:a?.onboarding?.website_url||"",social_links:{linkedin:a?.onboarding?.linkedin||""},faqs_text:a?.onboarding?.faqs_text||"",uploaded_files:a?.onboarding?.uploaded_files||[]},deployment_targets:{channels:a?.onboarding?.channels||[]},instructions:{dos_and_donts:a?.onboarding?.dos_and_donts||"",fallback_contacts:a?.onboarding?.fallback_contacts||""},targets:{success_goals:a?.onboarding?.success_goals||"",success_metrics:a?.onboarding?.success_metrics||""}}));I(ye),re(P);const b=P.total||D.total,we=P.totalPages||D.totalPages;b!==void 0&&(le(b),oe(we||Math.ceil(b/$)),te(a=>({...a,[s]:b})),console.log(`âœ… Set count for ${s}:`,b))}catch(l){console.error("âŒ Error fetching data:",l),T(l.message),I([])}finally{M(!1),A.current=!1}};n.useEffect(()=>{U()},[c,o]),n.useMemo(()=>{let s=h;return m&&(s=h.filter(i=>{const l=m.toLowerCase();return i.company_basics?.name?.toLowerCase().includes(l)||i.company_basics?.company_email?.toLowerCase().includes(l)||i.userData?.fullName?.toLowerCase().includes(l)||i.userData?.email?.toLowerCase().includes(l)})),s},[h,m]);const K=n.useMemo(()=>h,[h]),_=s=>se[s]||0,me=()=>{o>1&&v(s=>s-1)},xe=()=>{o<u&&v(s=>s+1)},pe=s=>{if(console.log("ðŸ” handleEditClient called with client:",s),!s?.id){console.error("âŒ No client.id available:",s),T("Client ID not found");return}L(s),R({_id:s._id||s.id,userData:s}),k("edit"),O(!1)},ue=s=>{V(s),F(!0)},ge=()=>{F(!1),V(null)},he=async()=>{if(x)try{const s=x?.id,i=x?.fullName||x?.name||"this client";if(console.log(`ðŸ—‘ï¸ Deleting client: ${i} (ID: ${s})`),!s){w.error("Client ID not found");return}const l=await z.deleteUser(s);l?.success?(w.success("Client deleted successfully"),await U(c,o)):w.error(l?.message||"Failed to delete client")}catch(s){console.error("âŒ Error deleting client:",s),w.error("Failed to delete client")}},fe=()=>{L(null),k("list"),R(null),O(!1),ee(null)},be=async s=>{try{console.log("ðŸ” handleViewClient called with client:",s),g(`/dashboard/clients/${s?.id||s?._id}`,{state:{client:s}})}catch(i){console.error("âŒ Error navigating to client details:",i),w.error("Failed to navigate to client details")}};return E==="agentView"&&B?e.jsx(Ie,{agent:B,onBack:fe,currentTheme:t}):E==="details"&&N?(g(`/dashboard/clients/${N._id||N.userData?._id}`,{state:{client:N}}),k("list"),null):e.jsxs("div",{className:"space-y-4 md:space-y-6 px-2 sm:px-0",children:[e.jsx("div",{className:"relative -mx-2 sm:mx-0",children:e.jsxs("div",{className:"flex gap-3 sm:gap-4 overflow-x-auto scrollbar-hide px-2 sm:px-0 snap-x snap-mandatory sm:grid sm:grid-cols-3",children:[e.jsx("div",{className:`${t.cardBg} border ${t.border} rounded-lg p-3 sm:p-4 shadow-sm min-w-[240px] sm:min-w-0 snap-center flex-shrink-0`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`w-8 h-8 sm:w-10 sm:h-10 rounded-lg ${t.searchBg} flex items-center justify-center flex-shrink-0`,children:e.jsx(Q,{className:`w-4 h-4 sm:w-5 sm:h-5 ${t.textSecondary}`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:`text-xs ${t.textSecondary} font-medium`,children:"All Clients"}),e.jsx("span",{className:"text-xs font-medium text-blue-500",children:"Total"})]}),e.jsx("h3",{className:`text-xl sm:text-2xl font-semibold ${t.text}`,children:r?.total||S||_("all")}),r&&e.jsxs("p",{className:`text-xs ${t.textSecondary}`,children:["Page ",r.page||o," of ",r.totalPages||u]})]})]})}),e.jsx("div",{className:`${t.cardBg} border ${t.border} rounded-lg p-3 sm:p-4 shadow-sm min-w-[240px] sm:min-w-0 snap-center flex-shrink-0`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`w-8 h-8 sm:w-10 sm:h-10 rounded-lg ${t.searchBg} flex items-center justify-center flex-shrink-0`,children:e.jsx(G,{className:`w-4 h-4 sm:w-5 sm:h-5 ${t.textSecondary}`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:`text-xs ${t.textSecondary} font-medium`,children:"Awaiting Review"}),e.jsx("span",{className:"text-xs font-medium text-yellow-500",children:"Pending"})]}),e.jsx("h3",{className:`text-xl sm:text-2xl font-semibold ${t.text}`,children:_("pending")})]})]})}),e.jsx("div",{className:`${t.cardBg} border ${t.border} rounded-lg p-3 sm:p-4 shadow-sm min-w-[240px] sm:min-w-0 snap-center flex-shrink-0`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`w-8 h-8 sm:w-10 sm:h-10 rounded-lg ${t.searchBg} flex items-center justify-center flex-shrink-0`,children:e.jsx(H,{className:`w-4 h-4 sm:w-5 sm:h-5 ${t.textSecondary}`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:`text-xs ${t.textSecondary} font-medium`,children:"Approved Clients"}),e.jsx("span",{className:"text-xs font-medium text-green-500",children:"Active"})]}),e.jsx("h3",{className:`text-xl sm:text-2xl font-semibold ${t.text}`,children:_("approved")})]})]})})]})}),e.jsxs("div",{className:`${t.cardBg} border ${t.border} rounded-lg p-3 sm:p-4 md:p-6 shadow-lg`,children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 md:gap-4 mb-4 md:mb-6",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:`text-lg md:text-xl font-semibold ${t.text} flex items-center gap-2`,children:[e.jsx(Q,{className:"w-4 h-4 md:w-5 md:h-5"}),"Client Requests"]}),e.jsxs("p",{className:`${t.textSecondary} text-xs md:text-sm mt-1`,children:["(",r?.total||S||_("all")," total)"]})]}),e.jsxs("div",{className:"flex items-center gap-2 md:gap-3 w-full sm:w-auto",children:[e.jsx("button",{onClick:()=>window.location.reload(),className:`p-2 rounded-lg ${t.hover} ${t.text} transition-all duration-200 flex-shrink-0`,title:"Refresh data",children:e.jsx(Se,{className:"w-4 h-4"})}),e.jsxs("div",{className:"relative flex-1 sm:flex-none",children:[e.jsx(_e,{className:`absolute right-3 top-1/2 transform -translate-y-1/2 w-4 h-4 ${t.textSecondary}`}),e.jsx("input",{type:"text",placeholder:"Search...",value:j,onChange:s=>X(s.target.value),className:`w-full sm:w-48 md:w-64 pl-10 sm:pl-9 pr-3 py-2 text-sm rounded-lg border ${t.border} ${t.bg} ${t.text} focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent`})]})]})]}),e.jsx("div",{className:`flex gap-1 mb-4 md:mb-6 border-b ${t.border} overflow-x-auto scrollbar-hide -mx-3 sm:mx-0 px-3 sm:px-0`,children:["all","newlySignup","pending","onboarded","approved","rejected"].map(s=>{const i={all:{icon:ke,label:"All"},newlySignup:{icon:Pe,label:"Newly Signup"},pending:{icon:G,label:"Pending"},onboarded:{icon:H,label:"Onboarded"},approved:{icon:De,label:"Approved"},rejected:{icon:Ce,label:"Rejected"}},{icon:l,label:d}=i[s];return e.jsx("button",{onClick:()=>Z(s),className:`flex-shrink-0 px-3 md:px-4 py-2 md:py-3 text-sm md:text-base font-medium transition-all duration-200 border-b-2 whitespace-nowrap ${c===s?`${t.activeBorder} ${t.text}`:`border-transparent ${t.textSecondary} ${t.hover}`}`,children:e.jsxs("div",{className:"flex items-center gap-1.5 md:gap-2",children:[e.jsx(l,{className:"w-3.5 h-3.5 md:w-4 md:h-4"}),e.jsx("span",{className:"text-sm md:text-base",children:d})]})},s)})}),e.jsx("div",{className:"space-y-3 md:space-y-4",children:ae?e.jsxs("div",{className:`text-center py-12 md:py-16 rounded-lg ${t.cardBg} border ${t.border}`,children:[e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 md:h-12 md:w-12 border-b-2 border-blue-500 mx-auto mb-3"}),e.jsx("h3",{className:`text-base md:text-lg font-semibold ${t.text} mb-2`,children:"Loading clients..."}),e.jsx("p",{className:`text-sm ${t.textSecondary}`,children:"Please wait while we fetch the data"})]}):K.length===0?e.jsxs("div",{className:`text-center py-8 md:py-12 rounded-lg ${t.cardBg} border ${t.border}`,children:[e.jsx(Te,{className:`w-10 h-10 md:w-12 md:h-12 mx-auto mb-2 md:mb-3 ${t.textSecondary}`}),e.jsx("h3",{className:`text-base md:text-lg font-semibold ${t.text} mb-1 md:mb-2`,children:m?"No matching clients":"No client requests yet"}),e.jsx("p",{className:`text-sm ${t.textSecondary}`,children:m?"Try adjusting your search criteria":"No client requests available"})]}):K?.map(s=>e.jsxs("div",{className:`${t.cardBg} border ${t.border} rounded-lg p-3 md:p-4 hover:shadow-md transition-all duration-200`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-2 md:mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2 md:gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:`w-9 h-9 md:w-10 md:h-10 rounded-lg ${t.activeBg} flex items-center justify-center flex-shrink-0`,children:e.jsx(Ae,{className:`w-4 h-4 md:w-5 md:h-5 ${t.text}`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:`font-semibold ${t.text} text-base md:text-lg truncate`,children:s?.userData?.fullName||s?.company_basics?.name||"Unknown"}),e.jsx("p",{className:`text-xs md:text-sm ${t.textSecondary} truncate`,children:s?.userData?.email||s?.company_basics?.company_email||"No email"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>be(s?.userData),className:`p-2 flex items-center justify-center ${t.textSecondary} rounded-lg ${t.activeBg} hover:scale-105 transition-all duration-200`,title:"View Client Details",children:e.jsx(Le,{className:"w-4 h-4"})}),(s?.userData?.isOnboarded||s?.isOnboarded)&&e.jsx("button",{onClick:()=>{const i=s?.id||s?._id||s?.userData?.id||s?.userData?._id;g(`/dashboard/clients/${i}?tab=employees`,{state:{client:s}})},className:`p-2 flex items-center justify-center ${t.textSecondary} rounded-lg ${t.activeBg} hover:scale-105 transition-all duration-200`,title:"View AI Employee Analytics",children:e.jsx(Ee,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>pe(s?.userData),className:`p-2 flex items-center justify-center ${t.textSecondary} rounded-lg ${t.activeBg} hover:scale-105 transition-all duration-200`,title:"Edit Client",children:e.jsx(Re,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>ue(s?.userData),className:"p-2 flex items-center justify-center text-red-500 rounded-lg hover:bg-red-50 hover:scale-105 transition-all duration-200",title:"Delete Client",children:e.jsx(Be,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 md:gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:`text-xs ${t.textSecondary} uppercase mb-0.5`,children:"Plan"}),e.jsx("p",{className:`${t.text} font-medium text-xs md:text-sm truncate`,children:(()=>{const i=s?.userData?.onboarding?.plan_type||s?.plan_details?.type,l=J.find(d=>d.apiKey===i);return l?`${l.name} (${l.price})`:i||"No plan"})()})]}),e.jsxs("div",{children:[e.jsx("p",{className:`text-xs ${t.textSecondary} uppercase`,children:"Company"}),e.jsx("p",{className:`${t.text} font-medium text-sm`,children:s?.userData?.onboarding?.company_name||"Unknown"})]}),e.jsxs("div",{children:[e.jsx("p",{className:`text-xs ${t.textSecondary} uppercase`,children:"Email"}),e.jsx("p",{className:`${t.text} font-medium text-sm truncate`,children:s?.userData?.onboarding?.company_email||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:`text-xs ${t.textSecondary} uppercase`,children:"AI Employees"}),e.jsx("p",{className:`${t.text} font-medium text-sm`,children:s?.userData?.onboarding?.ai_employee_count||(s?.ai_employees||[]).length})]})]})]},s.id))}),u>1&&e.jsxs("div",{className:`flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 md:gap-3 mt-4 md:mt-6 p-3 md:p-4 rounded-lg ${t.searchBg}`,children:[e.jsxs("div",{className:`text-xs md:text-sm ${t.textSecondary} text-center sm:text-left`,children:["Showing"," ",((r?.page||o)-1)*(r?.limit||$)+1," ","to"," ",Math.min((r?.page||o)*(r?.limit||$),r?.total||S)," ","of ",r?.total||S]}),e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("button",{onClick:me,disabled:o===1,className:`px-2.5 md:px-3 py-1.5 text-xs md:text-sm rounded-md transition-all duration-200 ${o===1?`${t.textSecondary} cursor-not-allowed opacity-50`:`${t.text} ${t.hover} hover:scale-105`}`,children:"Previous"}),e.jsxs("span",{className:`mx-2 md:mx-3 text-xs md:text-sm ${t.text}`,children:[r?.page||o,"/",r?.totalPages||u]}),e.jsx("button",{onClick:xe,disabled:o===u,className:`px-2.5 md:px-3 py-1.5 text-xs md:text-sm rounded-md transition-all duration-200 ${o===u?`${t.textSecondary} cursor-not-allowed opacity-50`:`${t.text} ${t.hover} hover:scale-105`}`,children:"Next"})]})]})]}),e.jsx(Me,{isOpen:ne,onClose:ge,onConfirm:he,title:"Delete Client",itemName:x?.fullName||x?.name||x?.email||"",itemType:"client",warningMessage:"All associated data including AI employees, transactions, and settings will be permanently deleted."})]})};export{as as AIEmployeesTab,Ie as AgentDetailsView,ns as ClientDetailsTab,is as OnboardingDataTab,ls as TransactionsTab,es as default};
